!function(a){EJSpeed.config({type:"{{",cache:!1}),a.state={url:null,module:null,id:null,action:null,params:null,reset:function(){a.state.url=null,a.state.module=null,a.state.id=null,a.state.action=null,a.state.params=null}},a.app="",a.init=function(){a.log({message:"Booting Gravity.",type:"info"}),a.route.init()}}(window.gravity=window.gravity||{},jQuery),gravity.config={},gravity.compile=function(a){gravity.log({message:"Compiling views.",type:"info"}),a=a||null;var b=new EJSpeed({text:a}).render();gravity.dom({target:"div#gravity-stage",compiledHtml:b})},gravity.core=function(){gravity.log({message:"Executing gravity core.",type:"info"}),"string"==typeof gravity.app[gravity.state.module]||(gravity.state.action&&gravity.app[gravity.state.module][gravity.state.id]?(gravity.log({message:"Running action on a module.",type:"info"}),gravity.app[gravity.state.module][gravity.state.action]):(gravity.log({message:"Running module index.",type:"info"}),gravity.app[gravity.state.module].index())),gravity.state.module&&"string"!=typeof gravity.app[gravity.state.module]?type="dynamic":gravity.load({dataType:"html",callback:function(){}})},gravity.dom=function(a){gravity.log({message:"Rendering to DOM.",type:"info"}),a.target&&"string"==typeof a.compiledHtml&&$(a.target).html(a.compiledHtml)},gravity.dom.empty=function(a){$(a.target).empty()},gravity.fn={contains:function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}},gravity.load=function(a){{var b=null,c=a.url||gravity.state.url||null,d=a.dataType||"html";a.data||null}gravity.log({message:"Loading ["+gravity.state.url+"]",type:"info"}),(gravity.state.url.indexOf(".html")>-1||"html"==d)&&(c="views/"+gravity.state.url,-1===c.indexOf(".html")&&(c+=".html")),$.ajax({url:c,type:"GET",dataType:d,success:function(a){b=a},error:function(a){switch(a.status){case 400:case 401:case 404:case 408:case 206:case 500:case 501:case 502:case 503:default:console.log(a),gravity.log({message:a.status,type:"error"}),gravity.state.reset(),gravity.state.url="system/error.html",gravity.load({data:b})}return!1}}).done(function(){gravity.compile(b)})},gravity.log=function(a){var a=a||{},b={};b.message="string"==typeof a?a:a.message,b.type=a.type||"log",b.message="GRAVITY: "+b.message||"GRAVITY: Unknown error",console[b.type](b.message)},gravity.process=function(){gravity.log({message:"Processing...",type:"info"})},gravity.render=function(a){gravity.log({message:"Rendering...",type:"info"}),"string"==typeof a&&$("div#gravity-stage").html(a)},gravity.route={init:function(){gravity.log({message:"Initializing router.",type:"info"}),$(window).on("hashchange",function(a){a.preventDefault(),a.stopPropagation();var b=window.location.hash,c=[];gravity.state.reset(),b.indexOf("#/")>-1?(c=b.substring(2).split("/"),gravity.state.url=b.substring(2),gravity.log({message:"Identified route: "+c.join(),type:"info"}),/^[a-z0-9]+$/i.test(c[0])&&gravity.app.hasOwnProperty([c[0]])?(console.log("qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"),gravity.state.module=c[0],gravity.state.id=c[1]||null,gravity.state.action=c[2]||null,gravity.state.params=c[3]||null,gravity.core()):(gravity.log({message:'The module "'+c[0]+'" does not exist, loading /'+c.join("/")+".html instead.",type:"log"}),gravity.core())):(gravity.log({message:"No routes specified, loading default route.",type:"log"}),gravity.state.url=gravity.app.index,gravity.log('Routing to "'+gravity.app.index+'"'),gravity.core())}),$(window).trigger("hashchange")},go:function(){}};